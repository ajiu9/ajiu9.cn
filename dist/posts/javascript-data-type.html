<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="author" content="Ajiu9"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="revisit-after" content="7 days"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="alternate" type="application/rss+xml" title="Ajiu9's Blog" href="/feed.xml"><meta name="msapplication-TileColor" content="#ffffff"><title>JavaScript-数据类型问题</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app-BROb2cwE.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-D6PxG2j1.css"><link rel="modulepreload" crossorigin="" href="/assets/javascript-data-type-BXMTaTtd.js"><meta property="og:title" content="JavaScript-数据类型问题"><meta name="twitter:title" content="JavaScript-数据类型问题"><meta property="og:image" content="https://ajiu9.cn/og/javascript-data-type.png"><meta name="twitter:image" content="https://ajiu9.cn/og/javascript-data-type.png"><meta name="twitter:card" content="summary_large_image"></head><body class="font-sans text-gray-700 dark:text-gray-200 relative"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-85f5ed95=""><a href="/" class="w-12 h-12 absolute xl:fixed m-5 select-none outline-none" focusable="false" data-v-85f5ed95=""><svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-85f5ed95="" data-v-576c64b6=""><title data-v-576c64b6="">Ajiu9</title><mask id="mask0_634_3" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="4" y="4" width="50" height="87" data-v-576c64b6=""><path d="M12.102 19.955c.845 0 1.657-.159 2.415-.473a5.514 5.514 0 0 0 2.01-1.436c.566-.631 1.023-1.436 1.358-2.394c.33-.95.498-2.077.498-3.352c0-1.286-.164-2.424-.487-3.382c-.327-.964-.78-1.776-1.348-2.415a5.44 5.44 0 0 0-2.01-1.448c-1.536-.631-3.393-.62-4.896.001a5.487 5.487 0 0 0-2.011 1.448c-.569.643-1.022 1.456-1.345 2.416c-.324.954-.488 2.092-.488 3.382c0 1.275.164 2.402.488 3.35c.323.953.776 1.759 1.346 2.396a5.515 5.515 0 0 0 2.011 1.435a6.404 6.404 0 0 0 2.459.472m-4.498-4.726c-.265-.805-.399-1.789-.399-2.927s.135-2.126.4-2.938c.261-.811.618-1.482 1.057-1.994a4.101 4.101 0 0 1 1.54-1.134a4.926 4.926 0 0 1 1.899-.371c.653 0 1.284.125 1.875.372a4.078 4.078 0 0 1 1.541 1.132c.441.516.798 1.187 1.059 1.994c.266.818.4 1.807.4 2.938s-.135 2.116-.399 2.927c-.262.799-.617 1.462-1.058 1.971a4.041 4.041 0 0 1-1.541 1.114a5.15 5.15 0 0 1-3.778 0a4.048 4.048 0 0 1-1.539-1.114c-.439-.505-.795-1.168-1.057-1.97m26.099 9.151c-.333-.963-.789-1.772-1.357-2.406a5.54 5.54 0 0 0-2.01-1.436c-1.516-.625-3.354-.625-4.884 0a5.503 5.503 0 0 0-2.021 1.436c-.567.634-1.021 1.444-1.349 2.408c-.322.956-.486 2.093-.486 3.38c0 1.272.164 2.399.487 3.351c.327.956.78 1.763 1.349 2.396a5.497 5.497 0 0 0 2.021 1.435a6.45 6.45 0 0 0 2.446.473a6.31 6.31 0 0 0 2.417-.473a5.62 5.62 0 0 0 2.019-1.434c.575-.635 1.036-1.44 1.369-2.396c.331-.95.499-2.078.499-3.352c-.001-1.287-.169-2.425-.5-3.382m-1.307 6.31c-.262.8-.618 1.467-1.059 1.981a3.996 3.996 0 0 1-1.54 1.124c-1.182.479-2.616.479-3.786 0a4 4 0 0 1-1.53-1.124c-.439-.512-.796-1.178-1.059-1.981c-.265-.807-.399-1.792-.399-2.929s.135-2.125.4-2.938c.262-.809.618-1.479 1.058-1.992c.435-.507.95-.889 1.532-1.135a4.852 4.852 0 0 1 1.885-.37c.667 0 1.306.125 1.896.37a4.111 4.111 0 0 1 1.542 1.134c.441.518.798 1.188 1.059 1.993c.266.818.4 1.808.4 2.938s-.134 2.117-.399 2.929M30.324 4.923a.813.813 0 0 0-.43.101c-.094.06-.185.142-.269.243L8.26 35.077h1.247a.8.8 0 0 0 .688-.357L31.549 4.923z" fill="white" data-v-576c64b6=""></path></mask><g mask="url(#mask0_634_3)" data-v-576c64b6=""><path class="path1" d="M12.102 19.955c.845 0 1.657-.159 2.415-.473a5.514 5.514 0 0 0 2.01-1.436c.566-.631 1.023-1.436 1.358-2.394c.33-.95.498-2.077.498-3.352c0-1.286-.164-2.424-.487-3.382c-.327-.964-.78-1.776-1.348-2.415a5.44 5.44 0 0 0-2.01-1.448c-1.536-.631-3.393-.62-4.896.001a5.487 5.487 0 0 0-2.011 1.448c-.569.643-1.022 1.456-1.345 2.416c-.324.954-.488 2.092-.488 3.382c0 1.275.164 2.402.488 3.35c.323.953.776 1.759 1.346 2.396a5.515 5.515 0 0 0 2.011 1.435a6.404 6.404 0 0 0 2.459.472m-4.498-4.726c-.265-.805-.399-1.789-.399-2.927s.135-2.126.4-2.938c.261-.811.618-1.482 1.057-1.994a4.101 4.101 0 0 1 1.54-1.134a4.926 4.926 0 0 1 1.899-.371c.653 0 1.284.125 1.875.372a4.078 4.078 0 0 1 1.541 1.132c.441.516.798 1.187 1.059 1.994c.266.818.4 1.807.4 2.938s-.135 2.116-.399 2.927c-.262.799-.617 1.462-1.058 1.971a4.041 4.041 0 0 1-1.541 1.114a5.15 5.15 0 0 1-3.778 0a4.048 4.048 0 0 1-1.539-1.114c-.439-.505-.795-1.168-1.057-1.97m26.099 9.151c-.333-.963-.789-1.772-1.357-2.406a5.54 5.54 0 0 0-2.01-1.436c-1.516-.625-3.354-.625-4.884 0a5.503 5.503 0 0 0-2.021 1.436c-.567.634-1.021 1.444-1.349 2.408c-.322.956-.486 2.093-.486 3.38c0 1.272.164 2.399.487 3.351c.327.956.78 1.763 1.349 2.396a5.497 5.497 0 0 0 2.021 1.435a6.45 6.45 0 0 0 2.446.473a6.31 6.31 0 0 0 2.417-.473a5.62 5.62 0 0 0 2.019-1.434c.575-.635 1.036-1.44 1.369-2.396c.331-.95.499-2.078.499-3.352c-.001-1.287-.169-2.425-.5-3.382m-1.307 6.31c-.262.8-.618 1.467-1.059 1.981a3.996 3.996 0 0 1-1.54 1.124c-1.182.479-2.616.479-3.786 0a4 4 0 0 1-1.53-1.124c-.439-.512-.796-1.178-1.059-1.981c-.265-.807-.399-1.792-.399-2.929s.135-2.125.4-2.938c.262-.809.618-1.479 1.058-1.992c.435-.507.95-.889 1.532-1.135a4.852 4.852 0 0 1 1.885-.37c.667 0 1.306.125 1.896.37a4.111 4.111 0 0 1 1.542 1.134c.441.518.798 1.188 1.059 1.993c.266.818.4 1.808.4 2.938s-.134 2.117-.399 2.929M30.324 4.923a.813.813 0 0 0-.43.101c-.094.06-.185.142-.269.243L8.26 35.077h1.247a.8.8 0 0 0 .688-.357L31.549 4.923z" stroke="black" stroke-width="2.5" stroke-linecap="round" data-v-576c64b6=""></path></g></svg></a><button title="Scroll to top" fixed="" right-3="" bottom-3="" w-10="" h-10="" hover:op100="" rounded-full="" hover-bg-hex-8883="" transition="" duration-300="" z-100="" print:hidden="" class="op0! pointer-events-none" data-v-85f5ed95=""><div i-ri-arrow-up-line="" data-v-85f5ed95=""></div></button><nav class="nav" data-v-85f5ed95=""><div class="spacer" data-v-85f5ed95=""></div><div class="right" print:op0="" data-v-85f5ed95=""><a href="/posts" class="" title="Blog" data-v-85f5ed95=""><span class="lt-md:hidden" data-v-85f5ed95="">博客</span><div i-ri-article-line="" md:hidden="" data-v-85f5ed95=""></div></a><a href="/projects" class="" title="Projects" data-v-85f5ed95=""><span class="lt-md:hidden" data-v-85f5ed95="">项目</span><div i-ri-lightbulb-line="" class="md:hidden" data-v-85f5ed95=""></div></a><a href="https://github.com/ajiu9" target="_blank" title="GitHub" class="lt-md:hidden" data-v-85f5ed95=""><div i-uil-github-alt="" data-v-85f5ed95=""></div></a><a href="/feed.xml" target="_blank" title="RSS" class="lt-md:hidden" data-v-85f5ed95=""><div i-la-rss-square="" style="font-size:1.25rem;margin:0 -.125rem" data-v-85f5ed95=""></div></a><a class="select-none" title="Toggle Color Scheme" data-v-85f5ed95=""><div i-ri-sun-line="" dark:i-ri-moon-line=""></div></a></div></nav></header><main class="px-7 py-10 of-x-hidden"><!--[--><!----><div class="prose m-auto mb-8"><h1 class="mb-0 slide-enter-50">JavaScript-数据类型问题</h1><p class="opacity-50 !-mt-6 slide-enter-50">Jan 20, 2021<!----></p><!----><!----><!----></div><article class=""><!--[--><div class="prose m-auto slide-enter-content"><p>我将从数据类型的概念、检测方法、转换方法三个方面梳理数据类型的知识点。能够熟练掌握数据类型的判断以及转换等知识点。（包括隐式转换等问题）。</p><h2 id="数据类型的概念" tabindex="-1">数据类型的概念 <a class="header-anchor" href="#数据类型的概念" aria-hidden="true">#</a></h2><p>JavaScript 的数据类型有下图所示的 8 种：</p><p><img src="https://static.ajiu9.cn/images/20240316205349r3tol1.png" alt="图片"></p><p>其中，前 7 种类型为基础类型，最后 1 种（Object）为引用类型，也是你需要重点关注的，因为它在日常工作中是使用得最频繁，也是需要关注最多技术细节的数据类型。 而引用数据类型（Object）又分为图上这几种常见的类型：Array - 数组对象、RegExp - 正则对象、Date - 日期对象、Math - 数学函数、Function - 函数对象。 因为各种 JavaScript 的数据类型最后都会在初始化之后放在不同的内存中，因此上面的数据类型大致可以分成两类来进行存储：</p><ol><li>基础类型存储在栈内存，被引用或拷贝时，会创建一个完全相等的变量；</li><li>引用类型存储在堆内存，存储的是地址，多个引用指向同一个地址，这里会涉及一个“共享”的概念。</li></ol><p>关于引用类型下面直接看两段代码：</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> a</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  name</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">lee</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  age</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 18</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> b</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> a</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">a</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 第一个console</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">b</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">son</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">a</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 第二个console</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">b</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 第三个console</span></span>
<span class="line"></span></code></pre><p>这道题比较简单，我们可以看到第一个 console 打出来 name 是 'lee'；但是在执行了 b.name='son' 之后，结果你会发现 a 和 b 的属性 name 都是 'son'，第二个和第三个打印结果是一样的，这里就体现了引用类型的“共享”的特性，即这两个值都存在同一块内存中共享，一个发生了改变，另外一个也随之跟着变化。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> a</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  name</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Julia</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  age</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 20</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#80A665;--s-light:#59873A"> change</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">o</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  o</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">age</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 24</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  o</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    name</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Kaph</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    age</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 30</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> o</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> b</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> change</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">a</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 注意这里没有new，后面new相关会有专门文章讲解</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">b</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">age</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 第一个console</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">a</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">age</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 第二个console</span></span>
<span class="line"></span></code></pre><p>这道题涉及了 function，通过上述代码可以看到第一个 console 的结果是 30，b 最后打印结果是 {name: "Kaph", age: 30}；第二个 console 的返回结果是 24，而 a 最后的打印结果是 {name: "Julia", age: 24}。</p><p>是不是和预想的有些区别？要注意的是，这里的 function 和 return 带来了不一样的东西。</p><p>原因在于：函数传参进来的 o，传递的是对象在堆中的内存地址值，通过调用 o.age = 24（第 7 行代码）确实改变了 a 对象的 age 属性；但是第 12 行代码的 return 却又把 o 变成了另一个内存地址，将 {name: "Kaph", age: 30} 存入其中，最后返回 b 的值就变成了 {name: "Kaph", age: 30}。而如果把第 12 行去掉，那么 b 就会返回 undefined。</p><h2 id="数据类型检测" tabindex="-1">数据类型检测 <a class="header-anchor" href="#数据类型检测" aria-hidden="true">#</a></h2><p>数据类型的判断方法其实有多种，比如 typeof 和 instanceof，下面我来重点介绍三种在工作中经常会遇到的数据类型检测方法。</p><h4 id="第一种判断方法：typeof" tabindex="-1">第一种判断方法：typeof <a class="header-anchor" href="#第一种判断方法：typeof" aria-hidden="true">#</a></h4><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'number'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'string'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'undefined'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'boolean'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#80A665;--s-light:#59873A"> Symbol</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'symbol'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'object'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#666666;--s-light:#999999"> []</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'object'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#666666;--s-light:#999999"> {}</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'object'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> console</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'object'</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">log</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 'function'</span></span>
<span class="line"></span></code></pre><p>可以看到，前 6 个都是基础数据类型，而为什么第 6 个 null 的 typeof 是 'object' 呢？虽然 typeof null 会输出 object，但这只是 JS 存在的一个悠久 Bug，不代表 null 就是引用数据类型，并且 null 本身也不是对象。因此，null 在 typeof 之后返回的是有问题的结果，不能作为判断 null 的方法。如果需要在 if 语句中判断是否为 null，直接通过 ‘===null’来判断就好。</p><p>此外还要注意，引用数据类型 Object，用 typeof 来判断的话，除了 function 会判断为 OK 以外，其余都是 'object'，是无法判断出来的。</p><h4 id="第二种判断方法：instanceof" tabindex="-1">第二种判断方法：instanceof <a class="header-anchor" href="#第二种判断方法：instanceof" aria-hidden="true">#</a></h4><p>new 一个对象，这个新对象就是它原型链继承上面的对象，通过 instanceof 能判断这个对象是否是之前那个构造函数生成的对象，这样就基本可以判断出这个新对象的数据类型。下面通过代码来了解一下。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> Car</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> {}</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> benz</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> Car</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">benz</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> instanceof</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> Car</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // true</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> car</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> String</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Mercedes Benz</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">car</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> instanceof</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> String</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // true</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Covid-19</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> instanceof</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> String</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // false</span></span>
<span class="line"></span></code></pre><p>上面就是用 instanceof 方法判断数据类型的大致流程，如果自己实现一个 instanceof 的底层实现，应该怎么写呢？请看下面的代码。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#80A665;--s-light:#59873A"> myInstanceof</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">left</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> right</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // 这里先用typeof来判断基础数据类型，如果是，直接返回false</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> left</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">object</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> left</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> false</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // getProtypeOf是Object对象自带的API，能够拿到参数的原型对象</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> proto</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">getPrototypeOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">left</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#4D9375;--s-light:#1E754F">true</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 循环往下寻找，直到找到相同的原型对象</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">proto</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      return</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> false</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">proto</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#B8A965;--s-light:#998418"> right</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      return</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// 找到相同原型对象，返回true</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    proto</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">getPrototypeof</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">proto</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// 验证一下自己实现的myInstanceof是否OK</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">myInstanceof</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">new</span><span style="--s-dark:#80A665;--s-light:#59873A"> Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">123</span><span style="--s-dark:#666666;--s-light:#999999">),</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> Number</span><span style="--s-dark:#666666;--s-light:#999999">))</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // true</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">myInstanceof</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">123</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> Number</span><span style="--s-dark:#666666;--s-light:#999999">))</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // false</span></span>
<span class="line"></span></code></pre><h4 id="第三种判断方法：object-prototype-tostring" tabindex="-1">第三种判断方法：Object.prototype.toString <a class="header-anchor" href="#第三种判断方法：object-prototype-tostring" aria-hidden="true">#</a></h4><p>toString() 是 Object 的原型方法，调用该方法，可以统一返回格式为 “[object Xxx]” 的字符串，其中 Xxx 就是对象的类型。对于 Object 对象，直接调用 toString() 就能返回 [object Object]；而对于其他对象，则需要通过 call 来调用，才能返回正确的类型信息。我们来看一下代码。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">({})</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Object]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">({})</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 同上结果，加上call也ok</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Number]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object String]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">true</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Boolean]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {})</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Function]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">null</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Null]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">undefined</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Undefined]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">123</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">g</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object RegExp]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">new</span><span style="--s-dark:#80A665;--s-light:#59873A"> Date</span><span style="--s-dark:#666666;--s-light:#999999">())</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Date]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">([])</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Array]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">document</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object HTMLDocument]"</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">window</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "[object Window]"</span></span>
<span class="line"></span></code></pre><p>可以看出：instanceof 可以准确地判断复杂引用数据类型，但是不能正确判断基础数据类型；</p><p>而 typeof 也存在弊端，它虽然可以判断基础数据类型（null 除外），但是引用数据类型中，除了 function 类型以外，其他的也无法判断；Object.prototype.toString.call() 可以很好地判断引用类型，甚至可以把 document 和 window 都区分开来。</p><p>但是在写判断条件的时候一定要注意，使用这个方法最后返回统一字符串格式为 "[object Xxx]" ，而这里字符串里面的 "Xxx" ，第一个首字母要大写（注意：使用 typeof 返回的是小写）。</p><p>下面来实现一个全局通用的数据类型判断方法，来加深你的理解，代码如下。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#80A665;--s-light:#59873A"> getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">obj</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> type</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> typeof</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> obj</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">object</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 先进行typeof判断，如果是基础数据类型，直接返回</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> type</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // 对于typeof返回结果是object的，再进行如下的判断，正则返回结果</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#B8A965;--s-light:#998418"> Object</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">prototype</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toString</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">call</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">obj</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">replace</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">^</span><span style="--s-dark:#E6CC77;--s-light:#BDA437">\[</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">object </span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\S</span><span style="--s-dark:#CB7676;--s-light:#AB5959">+</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#E6CC77;--s-light:#BDA437">\]</span><span style="--s-dark:#4D9375;--s-light:#1E754F">$</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">$1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 注意正则中间有个空格</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/* 代码验证，需要注意大小写，哪些是typeof判断，哪些是toString判断？思考下 */</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">([])</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "Array" typeof []是object，因此toString返回</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">123</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "string" typeof 直接返回</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">window</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "Window" toString返回</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">null</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "Null"首字母大写，typeof null是object，需toString来判断</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">undefined</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "undefined" typeof 直接返回</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "undefined" typeof 直接返回</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {})</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "function" typeof能判断，因此首字母小写</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">getType</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">123</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">g</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "RegExp" toString返回</span></span>
<span class="line"></span></code></pre><h3 id="数据类型转换" tabindex="-1">数据类型转换 <a class="header-anchor" href="#数据类型转换" aria-hidden="true">#</a></h3><p>在日常的开发中，经常会遇到 JavaScript 数据类型转换问题，有的时候需要我们主动进行强制转换，而有的时候 JavaScript 会进行隐式转换，隐式转换的时候就需要我们多加留心。</p><p>那么这部分都会涉及哪些内容呢？我们先看一段代码，了解下大致的情况。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">123</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 123</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">   // true</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // false</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> ''</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">       // true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !</span><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // true</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">null</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ==</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // true</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">null</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">     //0</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // 0</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">parseInt</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#666666;--s-light:#999999">);</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // NaN</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">{}</span><span style="--s-dark:#CB7676;--s-light:#AB5959">+</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">10</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0">           // 10</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> obj</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    [</span><span style="--s-dark:#BD976A;--s-light:#B07D48">Symbol</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toPrimitive</span><span style="--s-dark:#666666;--s-light:#999999">]()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        return</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 200</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">    valueOf</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        return</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 300</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">    toString</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        return</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Hello</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">obj</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 200</span><span style="--s-dark:#666666;--s-light:#999999">);</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 400</span></span>
<span class="line"></span></code></pre><p>上面这 12 个问题，基本涵盖了我们平常容易疏漏的一些情况，这就是在做数据类型转换时经常会遇到的强制转换和隐式转换的方式。</p><h4 id="强制类型转换" tabindex="-1">强制类型转换 <a class="header-anchor" href="#强制类型转换" aria-hidden="true">#</a></h4><p>强制类型转换方式包括 Number()、parseInt()、parseFloat()、toString()、String()、Boolean()，这几种方法都比较类似，通过字面意思可以很容易理解，都是通过自身的方法来进行数据类型的强制转换。下面我列举一些来详细说明。</p><p>上面代码中，第 8 行的结果是 0，第 9 行的结果同样是 0，第 10 行的结果是 NaN。这些都是很明显的强制类型转换，因为用到了 Number() 和 parseInt()。</p><p>其实上述几个强制类型转换的原理大致相同，下面我挑两个比较有代表性的方法进行讲解。</p><h4 id="number-方法的强制转换规则" tabindex="-1">Number() 方法的强制转换规则 <a class="header-anchor" href="#number-方法的强制转换规则" aria-hidden="true">#</a></h4><ol><li>如果是布尔值，true 和 false 分别被转换为 1 和 0；</li><li>如果是数字，返回自身；</li><li>如果是 null，返回 0；</li><li>如果是 undefined，返回 NaN；</li><li>如果是字符串，遵循以下规则：如果字符串中只包含数字（或者是0X/0x 开头的十六进制数字字符串，允许包含正负号），则将其转换为十进制；如果字符串中包含有效的浮点格式，将其转换为浮点数值；如果是空字符串，将其转换为 0；如果不是以上格式的字符串，均返回 NaN；</li><li>如果是 Symbol，抛出错误；</li><li>如果是对象，并且部署了 [Symbol.toPrimitive] ，那么调用此方法，否则调用对象的 valueOf()方法，然后依据前面的规则转换返回的值；如果转换的结果是 NaN ，则调用对象的 toString()方法，再次依照前面的顺序转换返回对应的值（Object 转换规则会在下面细讲）。</li></ol><p>下面通过一段代码来说明上述规则。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">true</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 1</span></span>
<span class="line"></span></code></pre><p>其中，我分别列举了比较常见的 Number 转换的例子，它们都会把对应的非数字类型转换成数字类型，而有一些实在无法转换成数字的，最后只能输出 NaN 的结果。</p><h3 id="boolean-方法的强制转换规则" tabindex="-1">Boolean() 方法的强制转换规则 <a class="header-anchor" href="#boolean-方法的强制转换规则" aria-hidden="true">#</a></h3><p>这个方法的规则是：除了 undefined、 null、 false、 ''、 0（包括 +0，-0）、 NaN 转换出来是 false，其他都是 true。</p><p>这个规则应该很好理解，没有那么多条条框框，我们还是通过代码来形成认知，如下所示。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">true</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 1</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">false</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 0</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">0111</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 111</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">null</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 0</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 0</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1a</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // NaN</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959">-</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0x11</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // -17</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">Number</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">0X11</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 17</span></span>
<span class="line"></span></code></pre><h3 id="隐式类型转换" tabindex="-1">隐式类型转换 <a class="header-anchor" href="#隐式类型转换" aria-hidden="true">#</a></h3><p>凡是通过逻辑运算符 (&amp;&amp;、 ||、 !)、运算符 (+、-、*、/)、关系操作符 (&gt;、 &lt;、 &lt;= 、&gt;=)、相等运算符 (==) 或者 if/while 条件的操作，如果遇到两个数据类型不一样的情况，都会出现隐式类型转换。这里你需要重点关注一下，因为比较隐蔽，特别容易让人忽视。</p><p>下面着重讲解一下日常用得比较多的“==”和“+”这两个符号的隐式转换规则。</p><h4 id="的隐式类型转换规则" tabindex="-1">'==' 的隐式类型转换规则 <a class="header-anchor" href="#的隐式类型转换规则" aria-hidden="true">#</a></h4><ol><li>如果类型相同，无须进行类型转换；</li><li>如果其中一个操作值是 null 或者 undefined，那么另一个操作符必须为 null 或者 undefined，才会返回 true，否则都返回 false；</li><li>如果其中一个是 Symbol 类型，那么返回 false；</li><li>两个操作值如果都为 string 和 number 类型，那么就会将字符串转换为 number；</li><li>如果一个操作值是 boolean，那么转换成 number；</li><li>如果一个操作值为 object 且另一方为 string、number 或者 symbol，就会把 object 转为原始类型再进行判断（调用 object 的 valueOf/toString 方法进行转换）。</li><li><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-"><span class="line"><span>null == undefined       // true  规则2</span></span>
<span class="line"><span></span></span></code></pre></li></ol><p>'+' 的隐式类型转换规则</p><p>'+' 号操作符，不仅可以用作数字相加，还可以用作字符串拼接。仅当 '+' 号两边都是数字时，进行的是加法运算；</p><ol><li><p>如果两边都是字符串，则直接拼接，无须进行隐式类型转换。</p></li><li><p>如果其中有一个是字符串，另外一个是 undefined、null 或布尔型，则调用 toString() 方法进行字符串拼接；如果是纯对象、数组、正则等，则默认调用对象的转换方法会存在优先级（下一讲会专门介绍），然后再进行拼接。</p></li><li><p>如果其中有一个是数字，另外一个是 undefined、null、布尔型或数字，则会将其转换成数字进行加法运算，对象的情况还是参考上一条规则。</p></li><li><p>如果其中一个是字符串、一个是数字，则按照字符串规则进行拼接。</p></li></ol><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 2</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 3  常规情况</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">2</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // '12' 常规情况</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// 下面看一下特殊情况</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// eslint-disable-next-line prefer-template</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "1undefined" 规则1，undefined转换字符串</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// eslint-disable-next-line prefer-template</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "1null" 规则1，null转换字符串</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// eslint-disable-next-line prefer-template</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // "1true" 规则1，true转换字符串</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// eslint-disable-next-line prefer-template</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#CB7676;--s-light:#AB5959">n</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // '11' 比较特殊字符串和BigInt相加，BigInt转换为字符串</span></span>
<span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // NaN  规则2，undefined转换数字相加NaN</span></span>
<span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 1    规则2，null转换为0</span></span>
<span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 2    规则2，true转换为1，二者相加为2</span></span>
<span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#CB7676;--s-light:#AB5959">n</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 错误  不能把BigInt和Number类型直接混合相加</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// eslint-disable-next-line prefer-template</span></span>
<span class="line"><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 3</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // '13' 规则3，字符串拼接</span></span>
<span class="line"></span></code></pre><p>整体来看，如果数据中有字符串，JavaScript 类型转换还是更倾向于转换成字符串，因为第三条规则中可以看到，在字符串和数字相加的过程中最后返回的还是字符串。</p><h4 id="object-的转换规则" tabindex="-1">Object 的转换规则 <a class="header-anchor" href="#object-的转换规则" aria-hidden="true">#</a></h4><p>对象转换的规则，会先调用内置的 [ToPrimitive] 函数，其规则逻辑如下：</p><ol><li><p>如果部署了 Symbol.toPrimitive 方法，优先调用再返回；</p></li><li><p>调用 valueOf()，如果转换为基础类型，则返回；</p></li><li><p>调用 toString()，如果转换为基础类型，则返回；</p></li><li><p>如果都没有返回基础类型，会报错。</p></li></ol><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-js"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> obj</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  value</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  valueOf</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 2</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  toString</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">3</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  },</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  [</span><span style="--s-dark:#BD976A;--s-light:#B07D48">Symbol</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">toPrimitive</span><span style="--s-dark:#666666;--s-light:#999999">]()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 4</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">obj</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> // 输出5</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// 因为有Symbol.toPrimitive，就优先执行这个；如果Symbol.toPrimitive这段代码删掉，则执行valueOf打印结果为3；如果valueOf也去掉，则调用toString返回'31'(字符串拼接)</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// 再看两个特殊的case：</span></span>
<span class="line"><span style="--s-dark:#4C9A91;--s-light:#2F798A">10</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#666666;--s-light:#999999"> {};</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// "10[object Object]"，注意：{}会默认调用valueOf是{}，不是基础类型继续转换，调用toString，返回结果"[object Object]"，于是和10进行'+'运算，按照字符串拼接规则来，参考'+'的规则C</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 2</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 4</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 5</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 10</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// "1,2,,4,510"，注意[1,2,undefined,4,5]会默认先调用valueOf结果还是这个数组，不是基础数据类型继续转换，也还是调用toString，返回"1,2,,4,5"，然后再和10进行运算，还是按照字符串拼接规则，参考'+'的第3条规则</span></span>
<span class="line"></span></code></pre><h3 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-hidden="true">#</a></h3><p>从三个方面学习了数据类型相关内容:</p><ul><li><p>数据类型的基本概念：这是必须掌握的知识点，作为深入理解 JavaScript 的基础。</p></li><li><p>数据类型的判断方法：typeof 和 instanceof，以及 Object.prototype.toString 的判断数据类型、手写 instanceof 代码片段。</p></li><li><p>数据类型的转换方式：两种数据类型的转换方式，日常写代码过程中隐式转换需要多留意，如果理解不到位，很容易引起在编码过程中的 bug，得到一些意想不到的结果。</p></li></ul></div><!--]--></article><div class="prose m-auto mt-8 mb-8 slide-enter animate-delay-500 print:hidden"><!----><br><span font-mono="" op50="">&gt; </span><a href="/posts" class="font-mono op50 hover:op75"></a></div><!--]--><div class="mt-10 mb-6 prose m-auto flex slide-enter animate-delay-1200!"><span class="text-sm op50">@2024-2025 湘ICP备2024048835号</span><div class="flex-auto"></div></div></main><!----><!--]--></div></body></html>