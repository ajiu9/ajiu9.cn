<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="author" content="Ajiu9"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="revisit-after" content="7 days"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="alternate" type="application/rss+xml" title="Ajiu9's Blog" href="/feed.xml"><meta name="msapplication-TileColor" content="#ffffff"><title>前端webpack构建提速</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app-CxIlpOwc.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-BZdLT1WZ.css"><link rel="modulepreload" crossorigin="" href="/assets/webpack-building-speed-up-KDidD0cd.js"><meta property="og:title" content="前端webpack构建提速"><meta name="twitter:title" content="前端webpack构建提速"><meta property="og:image" content="https://ajiu9.cn/og/webpack-building-speed-up.png"><meta name="twitter:image" content="https://ajiu9.cn/og/webpack-building-speed-up.png"><meta name="twitter:card" content="summary_large_image"></head><body class="font-sans text-gray-700 dark:text-gray-200 relative"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-89b7cfe3=""><a href="/" class="w-12 h-12 absolute xl:fixed m-5 select-none outline-none" focusable="false" data-v-89b7cfe3=""><svg class="svg" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-89b7cfe3="" data-v-6edbdcb7=""><title data-v-6edbdcb7="">Ajiu9</title><mask id="mask0_634_3" style="mask-type:alpha" width="47" height="80" data-v-6edbdcb7=""><path d="M23.5125 22.9252C33.7594 11.9188 21.3168 -4.95774 7.41017 3.11364C-6.49649 11.185 3.75055 40.5355 23.5125 22.9252ZM23.5125 22.9252C79.8707 -24.0356 12.5336 46.4057 12.5336 69.1523C12.5336 91.8989 36.8153 72.5834 16.9251 38.3343" fill="white" data-v-6edbdcb7=""></path></mask><g mask="url(#mask0_634_3)" data-v-6edbdcb7=""><path class="path1" d="M23.5125 22.9252C33.7594 11.9188 21.3168 -4.95774 7.41017 3.11364C-6.49649 11.185 3.75055 40.5355 23.5125 22.9252ZM23.5125 22.9252C79.8707 -24.0356 12.5336 46.4057 12.5336 69.1523C12.5336 91.8989 36.8153 72.5834 16.9251 38.3343" stroke="black" stroke-width="3.5" stroke-linecap="round" data-v-6edbdcb7=""></path></g></svg></a><button title="Scroll to top" fixed="" right-3="" bottom-3="" w-10="" h-10="" hover:op100="" rounded-full="" hover-bg-hex-8883="" transition="" duration-300="" z-100="" print:hidden="" class="op0! pointer-events-none" data-v-89b7cfe3=""><div i-ri-arrow-up-line="" data-v-89b7cfe3=""></div></button><nav class="nav" data-v-89b7cfe3=""><div class="spacer" data-v-89b7cfe3=""></div><div class="right" print:op0="" data-v-89b7cfe3=""><a href="/posts" class="router-link-active" title="Blog" data-v-89b7cfe3=""><span class="lt-md:hidden" data-v-89b7cfe3="">博客</span><div i-ri-article-line="" md:hidden="" data-v-89b7cfe3=""></div></a><a href="/projects" class="" title="Projects" data-v-89b7cfe3=""><span class="lt-md:hidden" data-v-89b7cfe3="">项目</span><div i-ri-lightbulb-line="" class="md:hidden" data-v-89b7cfe3=""></div></a><a href="/photos" class="" title="photos" data-v-89b7cfe3=""><span class="lt-md:hidden" data-v-89b7cfe3="">摄影</span><div i-arcticons:photoncamera="" class="md:hidden" data-v-89b7cfe3=""></div></a><a href="https://github.com/ajiu9" target="_blank" title="GitHub" class="lt-md:hidden" data-v-89b7cfe3=""><div i-uil-github-alt="" data-v-89b7cfe3=""></div></a><a href="/feed.xml" target="_blank" title="RSS" class="lt-md:hidden" data-v-89b7cfe3=""><div i-la-rss-square="" style="font-size:1.25rem;margin:0 -.125rem" data-v-89b7cfe3=""></div></a><a class="select-none" title="Toggle Color Scheme" data-v-89b7cfe3=""><div i-ri-sun-line="" dark:i-ri-moon-line=""></div></a></div></nav></header><main class="px-7 py-10 of-x-hidden"><!--[--><!----><div class="prose m-auto mb-8"><h1 class="mb-0 slide-enter-50">前端webpack构建提速</h1><p class="opacity-50 !-mt-6 slide-enter-50">Jan 4, 2023<!----></p><!----><!----><!----></div><article class=""><!--[--><div class="prose m-auto slide-enter-content"><p>1.使用speed-measure-webpack-plugin进行速度分析</p><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">// 安装</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">npm install </span><span style="--s-light:#D73A49;--s-dark:#F97583">--</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">save</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">dev speed</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">measure</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">webpack</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">plugin</span></span>
<span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">// 使用方式</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> SpeedMeasurePlugin</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> require</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">"speed-measure-webpack-plugin"</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> smp</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#D73A49;--s-dark:#F97583"> new</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> SpeedMeasurePlugin</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">();</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> webpackConfig</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> smp.</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">wrap</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">({</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  plugins: [</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">    new</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> MyPlugin</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">    new</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> MyOtherPlugin</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  ]</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">});</span></span></code></pre><ol start="2"><li>使用webpack-bundle-analyzer进行体积分析</li></ol><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">// 安装</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">npm install </span><span style="--s-light:#D73A49;--s-dark:#F97583">--</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">save</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">dev webpack</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">bundle</span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">analyzer</span></span>
<span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">// 使用</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> BundleAnalyzerPlugin</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> require</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'webpack-bundle-analyzer'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">).BundleAnalyzerPlugin;</span></span>
<span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8"> plugins: [</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">   new</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> BundleAnalyzerPlugin</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8"> ]</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">}</span></span></code></pre><ol start="3"><li>使用多进程、多实例构建<blockquote><p>使用<a href="https://webpack.js.org/loaders/thread-loader/" target="_blank" rel="noopener">thread-loader</a>: 每次 webpack 解析一个模块，thread-loader 会将它及它的依赖分配给 worker 线程中</p></blockquote></li></ol><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">// webpack.config.js</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> os</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> require</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'os'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> threads</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> os.</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">cpus</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">().</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">length</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">console.</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">info</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'编译线程数 =&gt; '</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">, threads)</span></span>
<span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  config.module</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .rule(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'vue'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .use(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'thread-loader'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .loader(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'thread-loader'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .options({</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      workers: threads</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    })</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">end</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  config.module</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">rule</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'js'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">use</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'thread-loader'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">loader</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'thread-loader'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">options</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">({</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      workers: threads</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    })</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    .</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">end</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">};</span></span></code></pre><ol start="4"><li>利用缓存提升二次构建速度<blockquote><p><a href="https://webpack.js.org/configuration/cache/#cachetype" target="_blank" rel="noopener">bable-loader</a>提供了一个参数来使用缓存, 有false,memory, filesystem等配置</p></blockquote></li></ol><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">  //...</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  cache: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    type: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'filesystem'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">};</span></span></code></pre><ol start="5"><li>在webpack构建过程中移除无用的css代码方式<blockquote><p><a href="https://www.npmjs.com/package/mini-css-extract-plugin" target="_blank" rel="noopener">mini-css-extract-plugin</a>此插件将CSS提取到单独的文件中。它为每个包含CSS的JS文件创建一个CSS文件。它支持CSS和SourceMaps的按需加载。 它建立在新的webpack v5功能之上，需要webpack 5才能工作。</p></blockquote></li></ol><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> MiniCssExtractPlugin</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> require</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">"mini-css-extract-plugin"</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  plugins: [</span><span style="--s-light:#D73A49;--s-dark:#F97583">new</span><span style="--s-light:#6F42C1;--s-dark:#B392F0"> MiniCssExtractPlugin</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">()],</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  module: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    rules: [</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\.</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">css</span><span style="--s-light:#D73A49;--s-dark:#F97583">$</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span><span style="--s-light:#D73A49;--s-dark:#F97583">i</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        use: [MiniCssExtractPlugin.loader, </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">"css-loader"</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">],</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    ],</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">};</span></span></code></pre><p>6.对图片进行优化</p><blockquote><p>使用<a href="https://webpack.js.org/configuration/module/#ruleparserdataurlcondition" target="_blank" rel="noopener">ruleparserdataurlcondition</a>减少http请求</p></blockquote><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">  //...</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  module: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    rules: [</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      {</span></span>
<span class="line"><span style="--s-light:#6A737D;--s-dark:#6A737D">        //...</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        parser: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          dataUrlCondition: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">            maxSize: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">4</span><span style="--s-light:#D73A49;--s-dark:#F97583"> *</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> 1024</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    ],</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">  },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">};</span></span></code></pre><p>7.在生产构建时，使用代码拆分、splitChunks优化</p><blockquote><p><a href="https://webpack.js.org/configuration/optimization/" target="_blank" rel="noopener">optimization</a>开启minimize： true, 配置<a href="https://webpack.js.org/configuration/optimization/#optimizationsplitchunks" target="_blank" rel="noopener">splitChunks</a>来拆分合并代码，优化生产环境的代码，对常用的公用代码使用CDN <a href="https://medium.com/webpack/webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization-be739a861366" target="_blank" rel="noopener">webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization</a> 比如对第二步中使用webpack-bundle-analyzer进行体积分析后得到的优化建议，可以配置一下代码来进行优化</p></blockquote><pre class="shiki shiki-themes github-light github-dark" style="--s-light:#24292e;--s-dark:#e1e4e8;--s-light-bg:#fff;--s-dark-bg:#24292e" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">exports</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">splitChunks: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'async'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      minChunks: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">1</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      maxInitialRequests: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">30</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      minSize: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">0</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      cacheGroups: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        default: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          minChunks: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">1</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          priority: </span><span style="--s-light:#D73A49;--s-dark:#F97583">-</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">20</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          reuseExistingChunk: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">true</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        coreJs: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.core-js'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">core-js</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        axios: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.axios'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">(axios</span><span style="--s-light:#D73A49;--s-dark:#F97583">|</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">axios-ex)</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        handsontable: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.handsontable'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">(handsontable</span><span style="--s-light:#D73A49;--s-dark:#F97583">|</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">@handsontable)</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        lodash: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.lodash'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">lodash</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        moment: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.moment'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">moment</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        i18n: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.i18n'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          test:</span><span style="--s-light:#032F62;--s-dark:#9ECBFF"> /</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">node_modules</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#DBEDFF">vue-i18n</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">[</span><span style="--s-light:#22863A;--s-dark:#85E89D;--s-light-font-weight:bold;--s-dark-font-weight:bold">\\</span><span style="--s-light:#005CC5;--s-dark:#79B8FF">/]</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">/</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        common: {</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          chunks: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'all'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          name: </span><span style="--s-light:#032F62;--s-dark:#9ECBFF">'lib.common'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          priority: </span><span style="--s-light:#005CC5;--s-dark:#79B8FF">0</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#6F42C1;--s-dark:#B392F0">          test</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#E36209;--s-dark:#FFAB70">module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">            const</span><span style="--s-light:#005CC5;--s-dark:#79B8FF"> includes</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">              'intro.js'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">              'countup.js'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">              'qs'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">              'node-rsa'</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">              'vue-grid-layout'</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--s-light:#D73A49;--s-dark:#F97583">            return</span><span style="--s-light:#24292E;--s-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">              module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.resource </span><span style="--s-light:#D73A49;--s-dark:#F97583">&amp;&amp;</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">              includes.</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">some</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span><span style="--s-light:#E36209;--s-dark:#FFAB70">pkg</span><span style="--s-light:#D73A49;--s-dark:#F97583"> =&gt;</span></span>
<span class="line"><span style="--s-light:#005CC5;--s-dark:#79B8FF">                module</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">.resource.</span><span style="--s-light:#6F42C1;--s-dark:#B392F0">includes</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--s-light:#032F62;--s-dark:#9ECBFF">                  `${</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">sep</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">}node_modules${</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">sep</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">}${</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">pkg</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">}${</span><span style="--s-light:#24292E;--s-dark:#E1E4E8">sep</span><span style="--s-light:#032F62;--s-dark:#9ECBFF">}`</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">                )</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">              )</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">            )</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">          }</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">      }</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="--s-light:#24292E;--s-dark:#E1E4E8">}</span></span></code></pre></div><!--]--></article><div class="prose m-auto mt-8 mb-8 slide-enter animate-delay-500 print:hidden"><!----><br><span font-mono="" op50="">&gt; </span><a href="/posts" class="router-link-active font-mono op50 hover:op75"></a></div><!--]--><div class="mt-10 mb-6 prose m-auto flex slide-enter animate-delay-1200!"><span class="text-sm op50">@2024-2025 湘ICP备2024048835号</span><div class="flex-auto"></div></div></main><!----><!--]--></div></body></html>