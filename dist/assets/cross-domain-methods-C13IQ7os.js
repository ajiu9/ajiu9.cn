import{u as n,_ as e}from"./WrapperPost.vue_vue_type_script_setup_true_lang-CyhTeEm9.js";import{o as E,c as i,w as p,a as s,b as a}from"./app-1mYAOVx5.js";const r=s("div",{class:"prose m-auto slide-enter-content"},[s("h4",{id:"什么是同源策略及限制",tabindex:"-1"},[a("什么是同源策略及限制 "),s("a",{class:"header-anchor",href:"#什么是同源策略及限制","aria-hidden":"true"},"#")]),s("p",null,"同源策略，它是由Netscape提出的一个著名的安全策略，现在所有支持JavaScript 的浏览器都会使用这个策略。限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的关键的安全机制。 所谓同源是指，域名，协议，端口（http协议的默认端口是80）相同。 例如一个浏览器的两个tab页中分别打开来百度和谷歌的页面，当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，即检查是否同源，只有和百度同源的脚本才会被执行。如果非同源，那么在请求数据时，浏览器会在控制台中报一个异常，提示拒绝访问。"),s("p",null,"限制："),s("ul",null,[s("li",null,[s("p",null,"Cookie、LocalStorage和IndexDB无法获取。")]),s("li",null,[s("p",null,"无法获取和操作DOM。")]),s("li",null,[s("p",null,"不能发送Ajax请求。")])]),s("h4",{id:"前后端如何通信",tabindex:"-1"},[a("前后端如何通信 "),s("a",{class:"header-anchor",href:"#前后端如何通信","aria-hidden":"true"},"#")]),s("ul",null,[s("li",null,[s("p",null,"Ajax：同源下的通信方式。")]),s("li",null,[s("p",null,"WebSocket：不受同源策略的限制，支持跨域。")]),s("li",null,[s("p",null,"CORS： CORS是跨源资源分享（Cross-Origin Resource Sharing）的缩写。它是W3C标准，是跨源AJAX请求的根本解决方法。相比JSONP只能发GET请求，CORS允许任何类型的请求。")])]),s("h4",{id:"如何创建ajax",tabindex:"-1"},[a("如何创建Ajax "),s("a",{class:"header-anchor",href:"#如何创建ajax","aria-hidden":"true"},"#")]),s("p",null,"需要知道以下几点："),s("ul",null,[s("li",null,[s("p",null,"XMLHttpRequest的工作原理")]),s("li",null,[s("p",null,"兼容性处理（XMLHttpRequest只在高版本的浏览器支持）")]),s("li",null,[s("p",null,"事件的触发条件")]),s("li",null,[s("p",null,"事件的触发顺序")])]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"ajax"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"options"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," opt"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," Object."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"assin"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"({")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    url: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"''"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    ype: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'get'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    data: {},")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"    success"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"() {},")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"    error"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"() {},")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }, options)")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (opt.url) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"    // 兼容性处理")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," xhr"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," XMLHttpRequest")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"      ?"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," new"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," XMLHttpRequest"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"()")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"      :"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," new"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," ActiveXObject"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'Microsoft.XMLHTTP'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," data"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," opt.data")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    let"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," opt.url")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," type"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," opt.type."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"toUpperCase"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"()")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," dataArr"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," []")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    for"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"const"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," k"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," in"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      dataArr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"push"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"`${"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"k"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}=${"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"data"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"["),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"k"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"]"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}`"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (type "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"==="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," 'GET'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," `${"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"url"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}?${"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"dataArr"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"join"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'&'"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},")"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}`")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      xhr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"open"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(type, url."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"replace"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"/"),s("span",{style:{"--s-light":"#22863A","--s-dark":"#85E89D","--s-light-font-weight":"bold","--s-dark-font-weight":"bold"}},"\\?"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"$"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"/"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"g"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"''"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"), "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"true"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      xhr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"send"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"()")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (type "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"==="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," 'POST'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      xhr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"open"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(type, url, "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"true"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      xmlhttp."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"setRequestHeader"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'Content-type'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'application/x-www-form-urlencoded'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      xhr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"send"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(dataArr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"join"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'&'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"))")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    xhr."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onload"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," () {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"      if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (xhr.status "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"==="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," 200"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ||"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," xhr "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"==="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," 304"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"        var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," res")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"        if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (opt.success "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"&&"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," opt.success "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"instanceof"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," Function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"          res "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," xhr.responseText")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"          if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"typeof"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," res "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"==="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," 'string'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"            res "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," JSON"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"parse"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(res)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"            opt.success."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"call"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(xhr, res)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"          }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"        }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"      else"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"        if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (opt.error "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"&&"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," opt.error "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"instanceof"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," Function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"          opt.error."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"call"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(xhr, res)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"}")])])]),s("h4",{id:"跨域通信的几种方式",tabindex:"-1"},[a("跨域通信的几种方式 "),s("a",{class:"header-anchor",href:"#跨域通信的几种方式","aria-hidden":"true"},"#")]),s("ul",null,[s("li",null,"jsonp"),s("li",null,"Hash"),s("li",null,"webSocket"),s("li",null,"postMessage"),s("li",null,"CORS")]),s("p",null,[s("strong",null,"1.jsonp"),a(" jsonp原理： 通过"),s("code",null,"<script>"),a("标签的异步加载来实现。例如在"),s("code",null,"<head>"),a("标签中通过"),s("code",null,"<script>"),a("中的url加载的js。")]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"/**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"* [function 拼接url]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"* "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@param"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"  {[Object]]}"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}}," [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"* "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@return"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," {[value=key&value1=key1]}"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}}," [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"*/"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," {}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"param"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"data"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," ''")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  for"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," k "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"in"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    let"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," value "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data[k] "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"!=="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," undefined"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ?"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data[k] "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},":"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," ''")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+="),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," `&${"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"k"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}=${"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"encodeURIComponent"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"("),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"value"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},")"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"}`")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  return"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"?"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," url."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"substring"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"1"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},":"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," ''")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"/**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * [function 判断是否为函数]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@param"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"  {[type]}"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," source"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}}," [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@return"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," {[type]}"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"        [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"isFunction"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"source"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  return"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," '[object Function]'"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ==="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," Object"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"."),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"prototype"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},".toString."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"call"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(source);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"/**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * [function 获取一个随机的5位字符串]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@param"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"  {[type]}"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," prefix"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}}," [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@return"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," {[type]}"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"        [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"getName"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"prefix"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    return"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," prefix "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," Math."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"random"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"()."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"toString"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"36"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"replace"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"/"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"["),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"^"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"a-z]"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"/"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"g"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"''"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"substr"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"0"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"5"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  };")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"/**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * [function 在页面中注入js脚本]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@param"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"  {[type]}"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," url"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"     [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@param"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"  {[type]}"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," charset"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}}," [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  * "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"@return"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," {[type]}"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"         [description]")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"createScript"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"url"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"charset"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," document."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"createElement"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'script'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  script."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"setAttribute"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'type'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'text/javascript'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  charset "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"&&"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"setAttribute"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'charset'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", charset);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  script."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"setAttribute"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'src'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", url);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  script.async "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," true"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  return"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// jsop实现")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"jsonp"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"url"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"data"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"onsuccess"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"onerror"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"charset"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 第一步，全局注册一个callback回调函数")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," callbackName "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"getName"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(_callback);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  window[callbackName] "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"() {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (onsuccess "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"&&"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," onsuccess.util.isFunction) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"       onsuccess"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"arguments"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"["),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"0"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"]);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 第二步 动态创建Script标签")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (url."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"indexOf"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'?'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"<"),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," 0"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ?"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," '?'"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," :"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," '&'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"param"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(data);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"createScript"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(url "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," '&callback='"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," +"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," callbackName, charset);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 第三步 发送script请求")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  document."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"getElementsByTagName"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'head'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")["),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"0"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"]."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"appendChild"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(script);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 第四步 监听函数")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  script.onload "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onreadystatechange"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," () {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"    if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"!"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"script.readyState "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"||"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," /"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#DBEDFF"}},"loaded"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"|"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#DBEDFF"}},"complete"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"/"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"test"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(script.readyState)) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      script.onload "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," script.onreadystatechange "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," null"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},";"),s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 移除该script的 DOM 对象")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"      if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (script.parentNode) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"        script.parentNode."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"removeChild"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(script);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"      }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"    // 删除函数或变量")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"    window[callbackName] "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}}," null"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"script."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onerror"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," () {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"  if"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," (onerror "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"&&"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"isFunction"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(onerror)) {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"    onerror"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"();")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"}")])])]),s("p",null,"实例："),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"util."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"jsonp"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  g_tk: "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"5381"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  inCharset: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'utf-8'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  outCharset: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'utf-8'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  notice: "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"0"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  format: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'jsonp'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  platform: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"' h5'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  uin: "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"0"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  needNewCode: "),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"}, "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," () {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"log"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#005CC5","--s-dark":"#79B8FF"}},"arguments"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},")")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"})")])])]),s("p",null,[s("strong",null,"2.Hash（片段识别符）"),a(" url的"),s("code",null,"#"),a("后面的内容就叫Hash。Hash的改变，页面不会刷新。这就是用 Hash 做跨域通信的基本原理(url的?后面的内容叫Search。Search的改变，会导致页面刷新)。 实例： 页面A通过iframe或frame嵌入了跨域页面B。 窗口可以把信息，写入子窗口的片段标识符。")]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," src "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," originURL "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}}," '#'"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," +"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," data;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"document."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"getElementById"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'myIFrame'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},").src "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," src;")])])]),s("p",null,"子窗口通过监听hashchange事件得到通知。"),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"window.onhashchange "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," checkMessage;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"function"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," checkMessage"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"() {"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," message "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," window.location.hash;")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// ...")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"}")])])]),s("p",null,"同样的，子窗口也可以改变父窗口的片段标识符。"),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"parent.location.href"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," target "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"+"),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},' "#"'),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," +"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," hash;")])])]),s("p",null,[s("strong",null,"3.postMessage"),a(" HTML5引入了一个全新的API：跨文档通信 API（Cross-document messaging）。这个API为window对象新增了一个window.postMessage方法，允许跨窗口通信，不论这两个窗口是否同源。")]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// postMessage")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 窗口A(http:A.com)向跨域的窗口B(http:B.com)发送信息B")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"window."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"postMessage"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'data'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'http://B.com'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 在窗口B中监听A")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"window."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"addEventListener"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'message'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"event"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {console."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"log"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"(event.origin)});")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 发送消息的窗口console.log(event.source); ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 消息发向的网址console.log(event.data); ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"// 消息内容}, false);")])])]),s("p",null,[s("strong",null,"4.webSocket"),a(" WebSocket是一种通信协议，使用ws://（非加密）和wss://（加密）作为协议前缀。该协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信。")]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"var"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ws "),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," new"),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}}," webSocket"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},'"wss://echo.websocket.org"'),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"ws."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onopen"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"evt"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {console."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"log"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},'"Connection open ..."'),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"ws."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"send"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},'"Hello WebSockets!"'),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"ws."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onmessage"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"evt"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {console."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"log"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"( "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},'"Received Message: "'),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," +"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," evt.data);")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"ws."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"close"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"();")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"ws."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"onclose"),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," ="),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}}," function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"evt"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {console."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"log"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},'"Connection closed."'),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"};")])])]),s("blockquote",null,[s("p",null,[a("Websocket【参考资料】"),s("a",{href:"http://www.ruanyifeng.com/blog/2017/05/websocket.html",target:"_blank",rel:"noopener"},"http://www.ruanyifeng.com/blog/2017/05/websocket.html")])]),s("p",null,[s("strong",null,"4.CORS"),a(" CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。 跨域时，浏览器会拦截Ajax请求，并在http头中加Origin。")]),s("pre",{class:"shiki shiki-themes github-light github-dark",style:{"--s-light":"#24292e","--s-dark":"#e1e4e8","--s-light-bg":"#fff","--s-dark-bg":"#24292e"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"fetch"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'/some/url/'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},", {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"  method: "),s("span",{style:{"--s-light":"#032F62","--s-dark":"#9ECBFF"}},"'get'"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"})."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"then"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"response"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 请求成功后执行操作")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"})."),s("span",{style:{"--s-light":"#6F42C1","--s-dark":"#B392F0"}},"catch"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"("),s("span",{style:{"--s-light":"#D73A49","--s-dark":"#F97583"}},"function"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}}," ("),s("span",{style:{"--s-light":"#E36209","--s-dark":"#FFAB70"}},"err"),s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#6A737D","--s-dark":"#6A737D"}},"  // 请求失败后执行操作")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--s-light":"#24292E","--s-dark":"#E1E4E8"}},"});")])])]),s("p",null,[s("a",{href:"http://www.ruanyifeng.com/blog/2016/04/cors.html",target:"_blank",rel:"noopener"},"CORS【参考资料】")])],-1),c={__name:"cross-domain-methods",setup(h){const l={title:"前端通信类以及跨域的几种方法",lang:"zh",type:"note",date:"2018-09-27T00:00:00.000Z",image:"https://ajiu9.cn/og/cross-domain-methods.png",meta:[{property:"og:title",content:"前端通信类以及跨域的几种方法"},{name:"twitter:title",content:"前端通信类以及跨域的几种方法"},{property:"og:image",content:"https://ajiu9.cn/og/cross-domain-methods.png"},{name:"twitter:image",content:"https://ajiu9.cn/og/cross-domain-methods.png"},{name:"twitter:card",content:"summary_large_image"}]};return n({title:"前端通信类以及跨域的几种方法",meta:[{property:"og:title",content:"前端通信类以及跨域的几种方法"},{name:"twitter:title",content:"前端通信类以及跨域的几种方法"},{property:"og:image",content:"https://ajiu9.cn/og/cross-domain-methods.png"},{name:"twitter:image",content:"https://ajiu9.cn/og/cross-domain-methods.png"},{name:"twitter:card",content:"summary_large_image"}]}),(g,k)=>{const t=e;return E(),i(t,{frontmatter:l},{default:p(()=>[r]),_:1})}}};export{c as default};
